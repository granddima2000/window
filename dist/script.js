(()=>{"use strict";const e=(e,t,n,o)=>{let l=1,s=!1;const a=document.querySelectorAll(e);function c(e){e>a.length?l=1:e<1&&(l=a.length),a.forEach((e=>{e.classList.add("animated"),e.style.display="none"})),a[l-1].style.display="block"}function r(e){c(l+=e)}c(l);try{const e=document.querySelector(n),t=document.querySelector(o);e.addEventListener("click",(()=>{r(-1),a[l-1].classList.remove("fadeInLeftBig"),a[l-1].classList.add("fadeInRightBig")})),t.addEventListener("click",(()=>{r(1),a[l-1].classList.add("fadeInLeftBig"),a[l-1].classList.remove("fadeInRightBig")}))}catch(e){}function i(){s="vertical"===t?setInterval((function(){r(1),a[l-1].classList.add("slideInDown")}),3e3):setInterval((function(){r(1),a[l-1].classList.remove("slideInRight"),a[l-1].classList.add("slideInLeft")}),3e3)}i(),a[0].parentNode.addEventListener("mouseenter",(()=>{clearInterval(s)})),a[0].parentNode.addEventListener("mouseleave",(()=>{i()}))},t=async(e,t)=>{let n=await fetch(e,{method:"POST",body:t});return await n.text()},n=async e=>{let t=await fetch(e);if(!t.ok)throw new Error(`Could not fetch ${e}, status ${t.status}`);return await t.json()},o=e=>{function t(e){let t="+7 (___) ___ __ __",n=0,o=t.replace(/\D/g,""),l=this.value.replace(/\D/g,"");o.length>=l.length&&(l=o),this.value=t.replace(/./g,(function(e){return/[_\d]/.test(e)&&n<l.length?l.charAt(n++):n>=l.length?"":e})),"blur"===e.type?2==this.value.length&&(this.value=""):((e,t)=>{if(t.focus(),t.setSelectorRange)t.setSelectorRange(e,e);else if(t.createTextRange){let n=t.createTextRange();n.collapse(!0),n.moveEnd("character",e),n.moveStart("character",e),n.select()}})(this.value.length,this)}document.querySelectorAll(e).forEach((e=>{e.addEventListener("input",t),e.addEventListener("focus",t),e.addEventListener("blur",t)}))},l=e=>{document.querySelectorAll(e).forEach((e=>{e.addEventListener("keypress",(function(e){e.key.match(/[^а-яё 0-9]/gi)&&e.preventDefault()})),e.addEventListener("input",(()=>{e.value.match(/[a-z]/gi)&&(e.value="")}))}))},s=(e,t)=>{document.querySelector(e).addEventListener("click",(function(){n("assets/db.json").then((e=>{e.styles.forEach((({src:e,title:n,link:o})=>{let l=document.createElement("div");l.classList.add("animated","fadeInUp","col-sm-3","col-sm-offset-0","col-xs-10","col-xs-offset-1"),l.innerHTML=`\n                <div class="styles-block">\n                    <img src=${e} alt="style">\n                    <h4>${n}</h4>\n                    <a href=${o}>Подробнее</a>\n                </div>\n            `,document.querySelector(t).appendChild(l)}))})).catch((()=>{let e=document.createElement("div");e.classList.add("status","animated","fadeInUp"),e.textContent="Произошла ошибка :(",e.style.cssText="text-align:center;font-size: 250%;color:red;",document.querySelector(t).appendChild(e)})),this.remove()}))},a=()=>{const e=document.querySelector(".portfolio-menu"),t=e.querySelectorAll("li"),n=e.querySelector(".all"),o=e.querySelector(".lovers"),l=e.querySelector(".chef"),s=e.querySelector(".girl"),a=e.querySelector(".guy"),c=e.querySelector(".grandmother"),r=e.querySelector(".granddad"),i=document.querySelector(".portfolio-wrapper"),d=i.querySelectorAll(".all"),u=i.querySelectorAll(".girl"),m=i.querySelectorAll(".lovers"),p=i.querySelectorAll(".chef"),y=i.querySelectorAll(".guy"),f=document.querySelector(".portfolio-no");[{selector:n,action:d},{selector:o,action:m},{selector:l,action:p},{selector:a,action:y},{selector:s,action:u},{selector:c,action:void 0},{selector:r,action:void 0}].forEach((({selector:e,action:t})=>{var n;n=t,e.addEventListener("click",(()=>{var e;e=n,d.forEach((e=>{e.style.display="none",e.classList.remove("animated","fadeIn")})),f.style.display="none",f.classList.remove("animated","fadeIn"),e?e.forEach((e=>{e.style.display="block",e.classList.add("animated","fadeIn")})):(f.style.display="block",f.classList.add("animated","fadeIn"))}))})),e.addEventListener("click",(e=>{let n=e.target;n&&"LI"==n.tagName&&(t.forEach((e=>e.classList.remove("active"))),n.classList.add("active"))}))},c=e=>{const t=document.querySelectorAll(e);t.forEach((e=>{e.addEventListener("click",(function(){const e=this.classList.contains("active-style");t.forEach((e=>{e.classList.remove("active-style"),e.nextElementSibling.classList.remove("active-content"),e.nextElementSibling.style.maxHeight="0px"})),e||(this.classList.add("active-style"),this.nextElementSibling.classList.add("active-content"),this.nextElementSibling.style.maxHeight=this.nextElementSibling.scrollHeight+80+"px")}))}))},r=e=>{const t=document.querySelector(e);window.addEventListener("scroll",(()=>{document.documentElement.scrollTop>1650?(t.classList.add("animated","fadeIn"),t.classList.remove("fadeOut")):(t.classList.remove("fadeIn"),t.classList.add("fadeOut"))})),document.querySelectorAll('[href^="#"]').forEach((e=>{e.addEventListener("click",(function(e){e.preventDefault();let t=document.documentElement.scrollTop,n=this.hash,o=document.querySelector(n).getBoundingClientRect().top,l=null;requestAnimationFrame((function e(s){null===l&&(l=s);let a=s-l,c=o<0?Math.max(t-a/.3,t+o):Math.min(t+a/.3,t+o);document.documentElement.scrollTo(0,c),c!=t+o?requestAnimationFrame(e):location.hash=n}))}))}))};window.addEventListener("DOMContentLoaded",(()=>{var i;(()=>{let e,t=!1;function n(n,l,s,a=!1){const c=document.querySelectorAll(n),r=document.querySelector(l),i=document.querySelector(s),d=document.querySelectorAll("[data-modal]"),u=o();c.forEach((n=>{n.addEventListener("click",(o=>{o.target&&o.preventDefault(),t=!0,a&&n.remove(),d.forEach((e=>{e.style.display="none",e.classList.add("animated","fadeIn")})),r.style.display="block",document.body.style.overflow="hidden",document.body.style.marginRight=`${u}px`,clearTimeout(e)}))})),i.addEventListener("click",(()=>{d.forEach((e=>{e.style.display="none"})),r.style.display="none",document.body.style.overflow="",document.body.style.marginRight="0px"})),r.addEventListener("click",(e=>{e.target===r&&(d.forEach((e=>{e.style.display="none"})),r.style.display="none",document.body.style.overflow="",document.body.style.marginRight="0px")}))}function o(){let e=document.createElement("div");e.style.width="50px",e.style.height="50px",e.style.overflowY="scroll",e.style.visibility="hidden",document.body.appendChild(e);let t=e.offsetWidth-e.clientWidth;return e.remove(),t}n(".button-design",".popup-design",".popup-design .popup-close"),n(".button-consultation",".popup-consultation",".popup-consultation .popup-close"),n(".fixed-gift",".popup-gift",".popup-gift .popup-close",!0),e=setTimeout((function(){let e;if(document.querySelectorAll("[data-modal]").forEach((t=>{"none"!==getComputedStyle(t).display&&(e="block")})),!e){document.querySelector(".popup-consultation").style.display="block",document.body.style.overflow="hidden";let e=o();document.body.style.marginRight=`${e}px`}}),51e3),window.addEventListener("scroll",(()=>{!t&&window.scrollY+document.documentElement.clientHeight>=document.documentElement.scrollHeight&&document.querySelector(".fixed-gift").click()}))})(),e(".feedback-slider-item","horizontal",".main-prev-btn",".main-next-btn"),e(".main-slider-item","vertical"),(()=>{const e=document.querySelectorAll("form"),n=document.querySelectorAll("input"),o=document.querySelectorAll('[name="upload"]');o.forEach((e=>{e.addEventListener("input",(()=>{let t;console.log(e.files[0]);const n=e.files[0].name.split(".");t=n[0].length>5?"...":".";const o=n[0].substring(0,5)+t+n[1];e.previousElementSibling.textContent=o}))})),e.forEach((e=>{e.addEventListener("submit",(l=>{l.preventDefault();let s=document.createElement("div");s.classList.add("status"),e.parentNode.appendChild(s),e.classList.add("animated","fadeOutUp"),setTimeout((()=>{e.style.display="none"}),400);let a=document.createElement("img");a.setAttribute("src","assets/img/spinner.gif"),a.classList.add("animated","fadeInUp"),s.appendChild(a);let c=document.createElement("div");c.textContent="Загрузка...",s.appendChild(c);const r=new FormData(e);let i;i=e.closest(".popup-design")||e.classList.contains("calc_form")?"assets/server.php":"assets/question.php",console.log(i),t(i,r).then((e=>{console.log(e),a.setAttribute("src","assets/img/ok.png"),c.textContent="Спасибо! Скоро с вами свяжутся"})).catch((()=>{a.setAttribute("src","assets/img/fail.png"),c.textContent="Что-то пошло не так"})).finally((()=>{n.forEach((e=>{e.value=""})),o.forEach((e=>{e.previousElementSibling.textContent="Файл не выбран"})),setTimeout((()=>{s.remove(),e.style.display="block",e.classList.remove("fadeOutUp"),e.classList.add("fadeInUp")}),5e3)}))}))}))})(),o('[name="phone"]'),l('[name="name"]'),l('[name="message"]'),s(".button-transparent","#styles .row"),(async(e,t,o,l,s)=>{const a=document.querySelector(e),c=document.querySelector(t),r=document.querySelector(o),i=document.querySelector(l),d=document.querySelector(s);let u,m=0;await n("assets/dbCalc.json").then((e=>{u=e})).catch((()=>{console.log("Ошибка")}));const p=(e,t)=>{e.innerHTML=t.map((e=>`<option value="${e.value}">${e.description}</option>`)).join("")};p(a,u.sizes),p(c,u.materials),p(r,u.options);const y=()=>{m=Math.round(+a.value*+c.value+ +r.value),console.log(+a.value),""==a.value||""==c.value?d.textContent="Необходимо выбрать размер картины и материал картины":"IWANTPOPART"===i.value?d.textContent=Math.round(.7*m):0!=m&&(d.textContent=m)};a.addEventListener("change",y),c.addEventListener("change",y),r.addEventListener("change",y),i.addEventListener("input",y)})("#size","#material","#options",".promocode",".calc-price"),a(),i=".sizes-block",document.querySelectorAll(i).forEach((e=>{e.addEventListener("mouseover",(()=>{!function(e){const t=e.querySelector("img");t.src=t.src.slice(0,-4)+"-1.png",e.querySelectorAll("p:not(.sizes-hit").forEach((e=>{e.style.display="none"}))}(e)})),e.addEventListener("mouseout",(()=>{!function(e){const t=e.querySelector("img");t.src=t.src.slice(0,-6)+".png",e.querySelectorAll("p:not(.sizes-hit").forEach((e=>{e.style.display="block"}))}(e)}))})),c(".accordion-heading"),((e,t)=>{const n=document.querySelector(e),o=document.querySelector(t);n.style.display="none",o.addEventListener("click",(()=>{"none"==n.style.display&&window.screen.availWidth<993?n.style.display="block":n.style.display="none"})),window.addEventListener("resize",(()=>{window.screen.availWidth<992&&(n.style.display="none")}))})(".burger-menu",".burger"),r(".pageup"),(()=>{const e=document.querySelectorAll('[name="upload"]');function n(e){e.preventDefault(),e.stopPropagation()}["dragenter","dragleave","dragover","drop"].forEach((t=>{e.forEach((e=>{e.addEventListener(t,n,!1)}))})),["dragenter","dragover"].forEach((t=>{e.forEach((e=>{e.addEventListener(t,(()=>{return(t=e).closest(".file_upload").style.border="5px solid yellow",void(t.closest(".file_upload").style.backgroundColor="rgba(0,0,0, .7)");var t}),!1)}))})),["dragleave","drop"].forEach((t=>{e.forEach((e=>{e.addEventListener(t,(()=>{return(t=e).closest(".file_upload").style.border="none",void(t.closest(".calc_form")?t.closest(".file_upload").style.backgroundColor="#fff":t.closest(".file_upload").style.backgroundColor="#ededed");var t}),!1)}))})),e.forEach((e=>{e.addEventListener("drop",(n=>{let o;e.files=n.dataTransfer.files;const l=e.files[0].name.split(".");o=l[0].length>5?"...":".";const s=l[0].substring(0,5)+o+l[1];if(e.previousElementSibling.textContent=s,e.closest(".mail")){let n=new FormData;e.files.forEach((e=>{n.append("image",e),t("assets/server.php",n).then((e=>console.log(e))).catch((e=>console.log(e)))}))}}))}))})()}))})();